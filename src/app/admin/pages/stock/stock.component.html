<!-- src/app/admin/pages/stock/stock.component.html -->

<div class="p-6 bg-gray-50 min-h-screen">
  <!-- Header Section -->
  <div class="mb-6">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Manajemen Stock Bahan Baku</h1>
        <p class="text-gray-600 mt-1">Kelola dan pantau stock bahan baku secara real-time</p>
      </div>

      <div class="flex flex-wrap gap-2">
        <button
          (click)="openPenerimaanModal()"
          class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 font-medium shadow-sm"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4v16m8-8H4"
            />
          </svg>
          Penerimaan
        </button>

        <button
          (click)="openPemakaianModal()"
          class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2 font-medium shadow-sm"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
          </svg>
          Pemakaian
        </button>

        <button
          (click)="openHistoryModal()"
          class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 font-medium shadow-sm"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          Riwayat Transaksi
        </button>
      </div>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
      <label class="text-sm font-medium text-gray-700 whitespace-nowrap">Filter Barang:</label>
      <select
        [value]="selectedBarang()"
        (change)="onBarangChange($any($event.target).value)"
        class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
        <option *ngFor="let option of bahanBakuOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>

      <button
        (click)="exportToExcel()"
        class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2 whitespace-nowrap"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        Export Excel
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="flex justify-center items-center py-12">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
  </div>

  <!-- Stock Cards Grid -->
  <div *ngIf="!isLoading()" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
    <div
      *ngFor="let item of filteredStockData()"
      class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-6"
    >
      <div class="flex items-start justify-between mb-4">
        <div>
          <h3 class="text-xl font-bold text-gray-900">{{ item.barang }}</h3>
          <p class="text-sm text-gray-500 mt-1">Update: {{ formatDate(item.last_updated) }}</p>
        </div>
        <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full">
          {{ item.satuan }}
        </span>
      </div>

      <div class="space-y-3">
        <div class="flex justify-between items-center py-2 border-b border-gray-100">
          <span class="text-sm text-gray-600">Stock Awal</span>
          <span class="text-sm font-medium text-gray-900">{{ formatNumber(item.stock_awal) }}</span>
        </div>

        <div class="flex justify-between items-center py-2 border-b border-gray-100">
          <span class="text-sm text-gray-600">Penerimaan</span>
          <span class="text-sm font-medium text-green-600"
            >+{{ formatNumber(item.penerimaan) }}</span
          >
        </div>

        <div class="flex justify-between items-center py-2 border-b border-gray-100">
          <span class="text-sm text-gray-600">Pemakaian</span>
          <span class="text-sm font-medium text-red-600">-{{ formatNumber(item.pemakaian) }}</span>
        </div>

        <div class="flex justify-between items-center pt-2">
          <span class="text-base font-semibold text-gray-900">Stock Akhir</span>
          <span class="text-lg font-bold text-blue-600">{{ formatNumber(item.stock_akhir) }}</span>
        </div>
      </div>

      <!-- Stock Status Indicator -->
      <div class="mt-4 pt-4 border-t border-gray-100">
        <div class="flex items-center gap-2">
          <div class="flex-1 bg-gray-200 rounded-full h-2">
            <div
              class="h-2 rounded-full transition-all"
              [class.bg-green-500]="item.stock_akhir / item.stock_awal > 0.5"
              [class.bg-yellow-500]="
                item.stock_akhir / item.stock_awal <= 0.5 &&
                item.stock_akhir / item.stock_awal > 0.2
              "
              [class.bg-red-500]="item.stock_akhir / item.stock_awal <= 0.2"
              [style.width.%]="(item.stock_akhir / item.stock_awal) * 100"
            ></div>
          </div>
          <span class="text-xs font-medium text-gray-600">
            {{ ((item.stock_akhir / item.stock_awal) * 100).toFixed(1) }}%
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Summary Statistics -->
  <div
    *ngIf="!isLoading() && filteredStockData().length > 0"
    class="bg-white rounded-lg shadow-md p-6"
  >
    <h2 class="text-xl font-bold text-gray-900 mb-4">Ringkasan Total</h2>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
      <div class="text-center">
        <p class="text-sm text-gray-600 mb-1">Total Stock Awal</p>
        <p class="text-2xl font-bold text-gray-900">
          {{ formatNumber(totalStockAwal()) }}
        </p>
        <p class="text-xs text-gray-500 mt-1">Kg</p>
      </div>

      <div class="text-center">
        <p class="text-sm text-gray-600 mb-1">Total Penerimaan</p>
        <p class="text-2xl font-bold text-green-600">
          {{ formatNumber(totalPenerimaan()) }}
        </p>
        <p class="text-xs text-gray-500 mt-1">Kg</p>
      </div>

      <div class="text-center">
        <p class="text-sm text-gray-600 mb-1">Total Pemakaian</p>
        <p class="text-2xl font-bold text-red-600">
          {{ formatNumber(totalPemakaian()) }}
        </p>
        <p class="text-xs text-gray-500 mt-1">Kg</p>
      </div>

      <div class="text-center">
        <p class="text-sm text-gray-600 mb-1">Total Stock Akhir</p>
        <p class="text-2xl font-bold text-blue-600">
          {{ formatNumber(totalStockAkhir()) }}
        </p>
        <p class="text-xs text-gray-500 mt-1">Kg</p>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div
    *ngIf="!isLoading() && filteredStockData().length === 0"
    class="bg-white rounded-lg shadow-md p-12 text-center"
  >
    <svg
      class="w-16 h-16 text-gray-400 mx-auto mb-4"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
      />
    </svg>
    <h3 class="text-xl font-semibold text-gray-900 mb-2">Tidak ada data stock</h3>
    <p class="text-gray-600">Data stock untuk barang yang dipilih tidak tersedia</p>
  </div>
</div>

<!-- Modal Penerimaan -->
<div
  *ngIf="showPenerimaanModal()"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"
  (click)="closePenerimaanModal()"
>
  <div
    class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
    (click)="$event.stopPropagation()"
  >
    <div
      class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"
    >
      <h2 class="text-2xl font-bold text-gray-900">Penerimaan Bahan Baku</h2>
      <button
        (click)="closePenerimaanModal()"
        class="text-gray-400 hover:text-gray-600 transition-colors"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>

    <form [formGroup]="penerimaanForm" (ngSubmit)="submitPenerimaan()" class="p-6 space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Jenis Barang <span class="text-red-500">*</span>
          </label>
          <select
            formControlName="barang"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
            <option value="">Pilih Barang</option>
            <option *ngFor="let option of bahanBakuOptions.slice(1)" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Jumlah (Kg) <span class="text-red-500">*</span>
          </label>
          <input
            type="number"
            formControlName="jumlah"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="0"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Nomor Bon <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="nomor_bon"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Contoh: DLK-001"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Nomor Kendaraan <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="nomor_kendaraan"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Contoh: BK 123 ADS"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Suplier <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="suplier"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Nama Suplier"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Supir <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="supir"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Nama Supir"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Tanggal <span class="text-red-500">*</span>
          </label>
          <input
            type="date"
            formControlName="tanggal"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Petugas <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="petugas"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Nama Petugas"
          />
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Keterangan</label>
        <textarea
          formControlName="keterangan"
          rows="3"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          placeholder="Keterangan tambahan (opsional)"
        ></textarea>
      </div>

      <div class="flex gap-3 pt-4">
        <button
          type="submit"
          [disabled]="!penerimaanForm.valid"
          class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium"
        >
          Simpan Penerimaan
        </button>
        <button
          type="button"
          (click)="closePenerimaanModal()"
          class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium"
        >
          Batal
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Pemakaian -->
<div
  *ngIf="showPemakaianModal()"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"
  (click)="closePemakaianModal()"
>
  <div
    class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
    (click)="$event.stopPropagation()"
  >
    <div
      class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"
    >
      <h2 class="text-2xl font-bold text-gray-900">Pemakaian Bahan Baku</h2>
      <button
        (click)="closePemakaianModal()"
        class="text-gray-400 hover:text-gray-600 transition-colors"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>

    <form [formGroup]="pemakaianForm" (ngSubmit)="submitPemakaian()" class="p-6 space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Jenis Barang <span class="text-red-500">*</span>
          </label>
          <select
            formControlName="barang"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
            <option value="">Pilih Barang</option>
            <option *ngFor="let option of bahanBakuOptions.slice(1)" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Jumlah (Kg) <span class="text-red-500">*</span>
          </label>
          <input
            type="number"
            formControlName="jumlah"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="0"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Nomor Bon <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="nomor_bon"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Contoh: PM-001"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Keperluan <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="keperluan"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Contoh: Produksi"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Tanggal <span class="text-red-500">*</span>
          </label>
          <input
            type="date"
            formControlName="tanggal"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Petugas <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            formControlName="petugas"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Nama Petugas"
          />
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Keterangan</label>
        <textarea
          formControlName="keterangan"
          rows="3"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          placeholder="Keterangan tambahan (opsional)"
        ></textarea>
      </div>

      <div class="flex gap-3 pt-4">
        <button
          type="submit"
          [disabled]="!pemakaianForm.valid"
          class="flex-1 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium"
        >
          Simpan Pemakaian
        </button>
        <button
          type="button"
          (click)="closePemakaianModal()"
          class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium"
        >
          Batal
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Riwayat Transaksi -->
<div
  *ngIf="showHistoryModal()"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"
  (click)="closeHistoryModal()"
>
  <div
    class="bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"
    (click)="$event.stopPropagation()"
  >
    <div
      class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"
    >
      <h2 class="text-2xl font-bold text-gray-900">Riwayat Transaksi</h2>
      <button
        (click)="closeHistoryModal()"
        class="text-gray-400 hover:text-gray-600 transition-colors"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>

    <!-- Filter Section -->
    <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div>
          <label class="block text-xs font-medium text-gray-700 mb-1">Jenis Barang</label>
          <select
            [value]="filterBarangHistory()"
            (change)="filterBarangHistory.set($any($event.target).value); applyHistoryFilter()"
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
            <option *ngFor="let option of bahanBakuOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>

        <div>
          <label class="block text-xs font-medium text-gray-700 mb-1">Jenis Transaksi</label>
          <select
            [value]="filterJenisTransaksi()"
            (change)="filterJenisTransaksi.set($any($event.target).value); applyHistoryFilter()"
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
            <option value="semua">Semua Transaksi</option>
            <option value="penerimaan">Penerimaan</option>
            <option value="pemakaian">Pemakaian</option>
          </select>
        </div>

        <div>
          <label class="block text-xs font-medium text-gray-700 mb-1">Dari Tanggal</label>
          <input
            type="date"
            [value]="filterDateFrom()"
            (change)="filterDateFrom.set($any($event.target).value); applyHistoryFilter()"
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          />
        </div>

        <div>
          <label class="block text-xs font-medium text-gray-700 mb-1">Sampai Tanggal</label>
          <input
            type="date"
            [value]="filterDateTo()"
            (change)="filterDateTo.set($any($event.target).value); applyHistoryFilter()"
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          />
        </div>
      </div>

      <div class="flex justify-end mt-3">
        <button
          (click)="resetHistoryFilter()"
          class="px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"
        >
          Reset Filter
        </button>
      </div>
    </div>

    <!-- Transaction List -->
    <div class="flex-1 overflow-y-auto p-6">
      <div *ngIf="filteredTransactions().length === 0" class="text-center py-12">
        <svg
          class="w-16 h-16 text-gray-400 mx-auto mb-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Tidak ada transaksi</h3>
        <p class="text-gray-600">Belum ada riwayat transaksi yang sesuai dengan filter</p>
      </div>

      <div class="space-y-3">
        <div
          *ngFor="let transaction of filteredTransactions()"
          class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"
        >
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-start gap-3">
              <div
                class="w-10 h-10 rounded-full flex items-center justify-center"
                [class.bg-green-100]="transaction.jenis === 'penerimaan'"
                [class.bg-red-100]="transaction.jenis === 'pemakaian'"
              >
                <svg
                  class="w-5 h-5"
                  [class.text-green-600]="transaction.jenis === 'penerimaan'"
                  [class.text-red-600]="transaction.jenis === 'pemakaian'"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    *ngIf="transaction.jenis === 'penerimaan'"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 4v16m8-8H4"
                  />
                  <path
                    *ngIf="transaction.jenis === 'pemakaian'"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20 12H4"
                  />
                </svg>
              </div>

              <div>
                <h4 class="font-semibold text-gray-900">{{ transaction.barang }}</h4>
                <div class="flex items-center gap-2 mt-1">
                  <span
                    class="px-2 py-1 text-xs font-medium rounded"
                    [class.bg-green-100]="transaction.jenis === 'penerimaan'"
                    [class.text-green-800]="transaction.jenis === 'penerimaan'"
                    [class.bg-red-100]="transaction.jenis === 'pemakaian'"
                    [class.text-red-800]="transaction.jenis === 'pemakaian'"
                  >
                    {{ transaction.jenis === 'penerimaan' ? 'Penerimaan' : 'Pemakaian' }}
                  </span>
                  <span class="text-xs text-gray-500">{{ transaction.nomor_bon }}</span>
                </div>
              </div>
            </div>

            <div class="text-right">
              <p
                class="text-lg font-bold"
                [class.text-green-600]="transaction.jenis === 'penerimaan'"
                [class.text-red-600]="transaction.jenis === 'pemakaian'"
              >
                {{ transaction.jenis === 'penerimaan' ? '+' : '-'
                }}{{ formatNumber(transaction.jumlah) }} Kg
              </p>
              <p class="text-xs text-gray-500 mt-1">{{ formatDate(transaction.tanggal) }}</p>
            </div>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-3 pt-3 border-t border-gray-100 text-sm">
            <div>
              <span class="text-gray-500 block text-xs">Nomor Kendaraan</span>
              <span class="font-medium text-gray-900">{{ transaction.nomor_kendaraan }}</span>
            </div>
            <div *ngIf="transaction.suplier">
              <span class="text-gray-500 block text-xs">Suplier</span>
              <span class="font-medium text-gray-900">{{ transaction.suplier }}</span>
            </div>
            <div>
              <span class="text-gray-500 block text-xs">Supir</span>
              <span class="font-medium text-gray-900">{{ transaction.supir }}</span>
            </div>
            <div>
              <span class="text-gray-500 block text-xs">Petugas</span>
              <span class="font-medium text-gray-900">{{ transaction.petugas }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
